<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>Ekansh vs KAJU KATLI</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
<style>
  html, body { margin:0; padding:0; background:#000; height:100%; overflow:hidden; }
</style>
</head>
<body>
<script>
const config = {
  type: Phaser.AUTO,
  width: window.innerWidth,
  height: window.innerHeight,
  backgroundColor: "#222",
  physics: {
    default: 'arcade',
    arcade: { gravity: { y: 1000 }, debug: false }
  },
  scene: { preload, create, update }
};
const game = new Phaser.Game(config);

let player, monster, cursors, scoreText, gameOver=false, score=0;

function preload() {
  // create textures (no images needed)
  const g = this.make.graphics({x:0,y:0,add:false});
  // player circle
  g.fillStyle(0x00ff66);
  g.fillCircle(25,25,25);
  g.generateTexture('player',50,50);
  g.clear();
  // monster diamond
  g.fillStyle(0xff3333);
  g.beginPath();
  g.moveTo(25,0); g.lineTo(50,25); g.lineTo(25,50); g.lineTo(0,25); g.closePath();
  g.fillPath();
  g.generateTexture('monster',50,50);
  g.destroy();
}

function create() {
  const w = this.scale.width;
  const h = this.scale.height;

  player = this.physics.add.sprite(w/2, h-100, 'player').setBounce(0).setCollideWorldBounds(true);
  monster = this.add.sprite(w/2, h-160, 'monster');
  this.add.text(player.x, player.y-50, 'Ekansh', {fontSize:'18px',fill:'#0f0'}).setOrigin(0.5).setDepth(5);
  this.add.text(monster.x, monster.y-50, 'KAJU KATLI', {fontSize:'18px',fill:'#f44'}).setOrigin(0.5).setDepth(5);

  // controls
  cursors = this.input.keyboard.createCursorKeys();
  this.input.on('pointerdown', ()=> jump(player));

  // coins & obstacles
  this.coins = this.physics.add.group();
  this.obstacles = this.physics.add.group();

  this.time.addEvent({ delay: 1200, loop:true, callback: ()=>{
    const x = Phaser.Math.Between(60, w-60);
    const coin = this.coins.create(x, -20, 'player');
    coin.setScale(0.4).setTint(0xffd700);
    coin.body.setAllowGravity(false);
    coin.body.setVelocityY(250);
  }});

  this.time.addEvent({ delay: 2000, loop:true, callback: ()=>{
    const x = Phaser.Math.Between(60, w-60);
    const obs = this.obstacles.create(x, -20, 'monster');
    obs.setScale(0.6).setTint(0x996600);
    obs.body.setAllowGravity(false);
    obs.body.setVelocityY(300);
  }});

  this.physics.add.overlap(player, this.coins, (p,c)=>{
    c.destroy();
    score += 10;
    scoreText.setText('Score: '+score);
  });

  this.physics.add.overlap(player, this.obstacles, ()=> endGame(this));

  scoreText = this.add.text(10,10,'Score: 0',{fontSize:'20px',fill:'#fff'});

  // monster follow player slowly
  this.monsterFollow = this.time.addEvent({
    delay:50, loop:true, callback: ()=>{
      if(!gameOver){
        monster.x += (player.x - monster.x)*0.05;
      }
    }
  });
}

function update() {
  if(gameOver) return;
  if(cursors.left.isDown) player.setVelocityX(-200);
  else if(cursors.right.isDown) player.setVelocityX(200);
  else player.setVelocityX(0);
}

function jump(p){
  if(p.body.touching.down) p.setVelocityY(-500);
}

function endGame(scene){
  gameOver = true;
  scene.add.text(scene.scale.width/2, scene.scale.height/2, 'GAME OVER\nTap to Restart',{fontSize:'28px',fill:'#fff',align:'center'}).setOrigin(0.5);
  scene.input.once('pointerdown', ()=> scene.scene.restart());
  score=0;
}
</script>
</body>
</html>
