<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Temple Run: Ekansh vs KAJU KATTRI</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.js"></script>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  height: 100%;
  background: #000;
}
#controls {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 20px;
  z-index: 10;
}
button {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  border: none;
  background: rgba(0,0,0,0.7);
  color: #fff;
  font-size: 30px;
  box-shadow: 0 0 10px #00ff00;
}
button:active {
  background: #00ff00;
  color: #000;
}
#restart {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #00ff00;
  color: #000;
  font-size: 26px;
  border: none;
  border-radius: 15px;
  padding: 15px 30px;
  z-index: 20;
}
</style>
</head>
<body>

<div id="controls" style="display:none;">
  <button id="left">‚¨ÖÔ∏è</button>
  <button id="jump">‚è´</button>
  <button id="right">‚û°Ô∏è</button>
</div>

<button id="restart">üîÅ Restart</button>

<script>
class StartScene extends Phaser.Scene {
  constructor() { super('StartScene'); }
  create() {
    const { width, height } = this.scale;
    this.add.text(width/2, height/2 - 100, 'Temple Run:\nEkansh vs KAJU KATTRI', 
      { fontSize: '34px', fill: '#00ff00', align: 'center' }).setOrigin(0.5);
    this.add.text(width/2, height/2 + 50, 'Tap to Start', 
      { fontSize: '26px', fill: '#fff' }).setOrigin(0.5);
    this.input.once('pointerdown', () => this.scene.start('GameScene'));
  }
}

class GameScene extends Phaser.Scene {
  constructor() { super('GameScene'); }

  create() {
    const { width, height } = this.scale;

    // Show controls
    document.getElementById('controls').style.display = 'flex';
    document.getElementById('restart').style.display = 'none';

    // Background color
    this.add.rectangle(width/2, height/2, width, height, 0x222222);

    // Lanes setup
    this.lanes = [width * 0.25, width * 0.5, width * 0.75];
    this.playerLane = 1;
    this.groundY = height - 120;
    this.isGameOver = false;
    this.score = 0;
    this.speed = 300;

    // Create shapes as placeholder sprites
    const graphics = this.add.graphics();
    graphics.fillStyle(0x00ff00);
    graphics.fillRect(0, 0, 60, 80);
    graphics.generateTexture('player', 60, 80);
    graphics.clear();

    graphics.fillStyle(0xff0000);
    graphics.fillRect(0, 0, 60, 80);
    graphics.generateTexture('monster', 60, 80);
    graphics.clear();

    graphics.fillStyle(0xffff00);
    graphics.fillCircle(15, 15, 15);
    graphics.generateTexture('coin', 30, 30);
    graphics.clear();

    graphics.fillStyle(0x888888);
    graphics.fillRect(0, 0, 60, 30);
    graphics.generateTexture('obstacle', 60, 30);
    graphics.destroy();

    // Physics groups
    this.obstacles = this.physics.add.group();
    this.coins = this.physics.add.group();

    // Player
    this.player = this.physics.add.sprite(this.lanes[this.playerLane], this.groundY, 'player').setScale(1);
    this.player.setCollideWorldBounds(true);
    this.player.body.setGravityY(1200);

    // Monster
    this.monster = this.add.sprite(this.lanes[0], this.groundY, 'monster').setScale(1);

    // Score
    this.scoreText = this.add.text(20, 20, 'Score: 0', { fontSize: '26px', fill: '#fff' });

    // Buttons
    document.getElementById('left').onclick = () => this.moveLeft();
    document.getElementById('right').onclick = () => this.moveRight();
    document.getElementById('jump').onclick = () => this.jump();

    // Collisions
    this.physics.add.overlap(this.player, this.obstacles, this.gameOver, null, this);
    this.physics.add.overlap(this.player, this.coins, this.collectCoin, null, this);

    // Spawn events
    this.time.addEvent({ delay: 2000, loop: true, callback: this.spawnObstacle, callbackScope: this });
    this.time.addEvent({ delay: 1200, loop: true, callback: this.spawnCoin, callbackScope: this });
  }

  moveLeft() {
    if (this.isGameOver) return;
    if (this.playerLane > 0) {
      this.playerLane--;
      this.tweens.add({ targets: this.player, x: this.lanes[this.playerLane], duration: 150, ease: 'Power2' });
    }
  }

  moveRight() {
    if (this.isGameOver) return;
    if (this.playerLane < 2) {
      this.playerLane++;
      this.tweens.add({ targets: this.player, x: this.lanes[this.playerLane], duration: 150, ease: 'Power2' });
    }
  }

  jump() {
    if (this.isGameOver) return;
    if (this.player.body.blocked.down) {
      this.player.setVelocityY(-550);
    }
  }

  spawnObstacle() {
    if (this.isGameOver) return;
    const lane = Phaser.Math.Between(0, 2);
    const obs = this.physics.add.sprite(this.lanes[lane], -30, 'obstacle').setScale(1);
    obs.body.setVelocityY(this.speed);
    obs.body.setAllowGravity(false);
    this.obstacles.add(obs);
  }

  spawnCoin() {
    if (this.isGameOver) return;
    const lane = Phaser.Math.Between(0, 2);
    const coin = this.physics.add.sprite(this.lanes[lane], -30, 'coin').setScale(1);
    coin.body.setVelocityY(this.speed * 0.9);
    coin.body.setAllowGravity(false);
    this.coins.add(coin);
  }

  collectCoin(player, coin) {
    coin.destroy();
    this.score += 10;
    this.scoreText.setText('Score: ' + Math.floor(this.score));
  }

  gameOver() {
    if (this.isGameOver) return;
    this.isGameOver = true;
    document.getElementById('controls').style.display = 'none';
    document.getElementById('restart').style.display = 'block';
    this.add.rectangle(this.scale.width/2, this.scale.height/2, this.scale.width, this.scale.height, 0x000000, 0.5);
    this.add.text(this.scale.width/2, this.scale.height/2 - 40, 'GAME OVER üò¢', { fontSize: '40px', fill: '#ff3333' }).setOrigin(0.5);
    document.getElementById('restart').onclick = () => this.scene.restart();
  }

  update() {
    if (this.isGameOver) return;
    this.obstacles.children.iterate(c => { if (c.y > this.scale.height + 50) c.destroy(); });
    this.coins.children.iterate(c => { if (c.y > this.scale.height + 50) c.destroy(); });
    this.score += 0.05;
    this.scoreText.setText('Score: ' + Math.floor(this.score));
  }
}

const config = {
  type: Phaser.AUTO,
  scale: { mode: Phaser.Scale.FIT, autoCenter: Phaser.Scale.CENTER_BOTH, width: window.innerWidth, height: window.innerHeight },
  physics: { default: 'arcade', arcade: { gravity: { y: 0 }, debug: false } },
  scene: [StartScene, GameScene]
};

new Phaser.Game(config);
</script>
</body>
</html>
