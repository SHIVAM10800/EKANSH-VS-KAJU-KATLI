<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>Ekansh vs Kaju Katli & Kopra Pathi</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
<style>
  html, body { margin:0; padding:0; background:#000; height:100%; overflow:hidden; }
</style>
</head>
<body>
<script>
const config = {
  type: Phaser.AUTO,
  width: window.innerWidth,
  height: window.innerHeight,
  backgroundColor: "#111",
  physics: { default: 'arcade', arcade: { debug: false } },
  scene: { preload, create, update }
};
const game = new Phaser.Game(config);

let player, scoreText, gameOverText, score = 0, gameOver = false;

function preload() {
  // Load your local images (must be in same folder)
  this.load.image('player', 'ekansh.png');   // EKANSH image
  this.load.image('good', 'kopra Pathi.png');      // KOPRA PATHI image
  this.load.image('danger', 'kaju Katli.png');     // KAJU KATLI image
}

function create() {
  const w = this.scale.width;
  const h = this.scale.height;
  gameOver = false;
  score = 0;

  // Player EKANSH
  player = this.physics.add.sprite(w/2, h-80, 'player')
    .setScale(0.2) // small circular player
    .setCollideWorldBounds(true);
  player.nameText = this.add.text(player.x, player.y-50, 'EKANSH', { fontSize:'18px', fill:'#00ff00' }).setOrigin(0.5);

  // Touch Control (move finger to move)
  this.input.on('pointermove', pointer => { if (!gameOver) player.x = pointer.x; });

  // Groups for balls
  this.goodBalls = this.physics.add.group();
  this.badBalls = this.physics.add.group();

  // Spawn balls continuously
  this.time.addEvent({ delay: 900, loop: true, callback: ()=>spawnBall(this) });

  // Score text
  scoreText = this.add.text(20,20,'Score: 0',{ fontSize:'24px', fill:'#fff' });

  // Collisions
  this.physics.add.overlap(player, this.goodBalls, (p,ball)=>{
    if (ball.nameText) ball.nameText.destroy();
    ball.destroy();
    score += 10;
    scoreText.setText('Score: ' + score);
  });

  this.physics.add.overlap(player, this.badBalls, (p,ball)=>{
    if (ball.nameText) ball.nameText.destroy();
    ball.destroy();
    endGame(this);
  });
}

// ðŸŸ¢ & ðŸ”´ Spawn function
function spawnBall(scene){
  if (gameOver) return;
  const w = scene.scale.width;
  const isGood = Phaser.Math.Between(0,1);
  const x = Phaser.Math.Between(40, w-40);
  let ball, name;
  if (isGood){
    ball = scene.goodBalls.create(x, -20, 'good').setScale(0.15); // KOPRA PATHI
    name = scene.add.text(ball.x, ball.y-25, 'KOPRA PATHI', {fontSize:'14px', fill:'#0ff'}).setOrigin(0.5);
  } else {
    ball = scene.badBalls.create(x, -20, 'danger').setScale(0.15); // KAJU KATLI (same size)
    name = scene.add.text(ball.x, ball.y-25, 'KAJU KATLI', {fontSize:'14px', fill:'#f55'}).setOrigin(0.5);
  }
  ball.body.setVelocityY(180 + Phaser.Math.Between(0,70));
  ball.nameText = name;
}

function update() {
  if (gameOver) return;

  // Update text positions and clean off-screen objects
  this.goodBalls.children.iterate(b => {
    if (b && b.nameText){
      b.nameText.setPosition(b.x,b.y-25);
      if (b.y > this.scale.height+40){ b.nameText.destroy(); b.destroy(); }
    }
  });
  this.badBalls.children.iterate(b => {
    if (b && b.nameText){
      b.nameText.setPosition(b.x,b.y-25);
      if (b.y > this.scale.height+40){ b.nameText.destroy(); b.destroy(); }
    }
  });

  // Keep EKANSH name above player
  if (player && player.nameText) player.nameText.setPosition(player.x, player.y-50);
}

// ðŸ’€ Game Over
function endGame(scene){
  if (gameOver) return;
  gameOver = true;

  scene.goodBalls.setVelocityY(0);
  scene.badBalls.setVelocityY(0);
  scene.goodBalls.children.iterate(b => { if(b.nameText) b.nameText.destroy(); });
  scene.badBalls.children.iterate(b => { if(b.nameText) b.nameText.destroy(); });

  gameOverText = scene.add.text(scene.scale.width/2, scene.scale.height/2,
    'ðŸ’€ GAME OVER ðŸ’€\nTap to Restart',
    {fontSize:'26px',fill:'#fff',align:'center'}).setOrigin(0.5);

  scene.input.once('pointerdown', () => {
    gameOverText.destroy();
    scene.scene.restart();
  });
}
</script>
</body>
</html>
