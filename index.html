<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>Temple Run: Ekansh vs KAJU KATLI</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.js"></script>
<style>
  body { margin:0; background:#000; overflow:hidden; }
  canvas { display:block; margin:auto; touch-action:none; }
  .controls {
    position:fixed;
    bottom:20px; left:50%; transform:translateX(-50%);
    display:flex; gap:20px; z-index:10;
  }
  button {
    width:70px; height:70px; border:none; border-radius:50%;
    background:#333; color:#fff; font-size:28px;
    box-shadow:0 0 10px #0f0;
  }
  button:active { background:#0f0; color:#000; }
</style>
</head>
<body>

<div class="controls" id="controls" style="display:none;">
  <button id="left">⬅️</button>
  <button id="jump">⏫</button>
  <button id="right">➡️</button>
</div>

<script>
class StartScene extends Phaser.Scene {
  constructor(){ super('StartScene'); }
  create(){
    this.add.text(400,250,'Temple Run:\nEkansh vs KAJU KATLI',
      {fontSize:'32px',fill:'#00ff00',align:'center'}).setOrigin(0.5);
    this.add.text(400,400,'Tap to Start',{fontSize:'24px',fill:'#fff'}).setOrigin(0.5);
    this.input.once('pointerdown',()=>this.scene.start('GameScene'));
  }
}

class GameScene extends Phaser.Scene {
  constructor(){ super('GameScene'); }

  create(){
    document.getElementById('controls').style.display='flex';

    this.lanes=[160,400,640];
    this.playerLane=1;
    this.score=0;
    this.gameOver=false;

    // Background
    this.add.rectangle(400,300,800,600,0x111111);

    // Player (Ekansh) - Circle
    this.player=this.add.circle(this.lanes[this.playerLane],500,30,0x00ff00);
    this.physics.add.existing(this.player);
    this.player.body.setCollideWorldBounds(true);
    this.playerName=this.add.text(this.player.x,450,'Ekansh',
      {fontSize:'20px',fill:'#00ff00'}).setOrigin(0.5);

    // Monster (KAJU KATLI) - Diamond shape
    this.monster=this.add.polygon(this.lanes[0],550,[0,-40,40,0,0,40,-40,0],0xff0000);
    this.monsterName=this.add.text(this.monster.x,510,'KAJU KATLI',
      {fontSize:'20px',fill:'#ff5555'}).setOrigin(0.5);

    // Groups
    this.obstacles=this.physics.add.group();
    this.coins=this.physics.add.group();

    // Score
    this.scoreText=this.add.text(20,20,'Score: 0',{fontSize:'26px',fill:'#fff'});

    // Buttons
    document.getElementById('left').onclick=()=>this.moveLeft();
    document.getElementById('right').onclick=()=>this.moveRight();
    document.getElementById('jump').onclick=()=>this.jump();

    // Spawn objects
    this.time.addEvent({delay:1500,loop:true,callback:()=>this.spawnObstacle()});
    this.time.addEvent({delay:1200,loop:true,callback:()=>this.spawnCoin()});
  }

  moveLeft(){
    if(this.gameOver) return;
    if(this.playerLane>0){
      this.playerLane--;
      this.tweens.add({
        targets:this.player,
        x:this.lanes[this.playerLane],
        duration:150,
        onUpdate:()=>this.playerName.setX(this.player.x)
      });
    }
  }

  moveRight(){
    if(this.gameOver) return;
    if(this.playerLane<2){
      this.playerLane++;
      this.tweens.add({
        targets:this.player,
        x:this.lanes[this.playerLane],
        duration:150,
        onUpdate:()=>this.playerName.setX(this.player.x)
      });
    }
  }

  jump(){
    if(this.gameOver) return;
    if(this.player.y>=500){
      this.tweens.add({
        targets:this.player,
        y:350,
        duration:300,
        yoyo:true,
        ease:'Power1',
        onUpdate:()=>this.playerName.setY(this.player.y-50)
      });
    }
  }

  spawnObstacle(){
    if(this.gameOver) return;
    const lane=Phaser.Math.Between(0,2);
    const obs=this.add.rectangle(this.lanes[lane],0,50,50,0xff8800);
    this.physics.add.existing(obs);
    obs.body.setVelocityY(300);
    this.obstacles.add(obs);
  }

  spawnCoin(){
    if(this.gameOver) return;
    const lane=Phaser.Math.Between(0,2);
    const coin=this.add.circle(this.lanes[lane],0,20,0xffff00);
    this.physics.add.existing(coin);
    coin.body.setVelocityY(250);
    this.coins.add(coin);
  }

  update(){
    if(this.gameOver) return;

    // Monster follows player
    this.monster.x=Phaser.Math.Linear(this.monster.x,this.lanes[this.playerLane],0.02);
    this.monsterName.setX(this.monster.x);

    // Check collisions
    this.obstacles.children.each(obs=>{
      if(obs.y>600) obs.destroy();
      if(Phaser.Geom.Intersects.CircleToRectangle(this.player.getBounds(),obs.getBounds())){
        this.endGame();
      }
    });

    this.coins.children.each(coin=>{
      if(coin.y>600) coin.destroy();
      if(Phaser.Geom.Intersects.CircleToCircle(this.player,coin)){
        coin.destroy();
        this.score+=10;
      }
    });

    // Update names position
    this.playerName.setPosition(this.player.x,this.player.y-50);

    // Update score
    this.score+=0.05;
    this.scoreText.setText('Score: '+Math.floor(this.score));
  }

  endGame(){
    this.gameOver=true;
    document.getElementById('controls').style.display='none';
    this.add.text(400,300,'GAME OVER\nTap to Restart',{fontSize:'30px',fill:'#fff',align:'center'}).setOrigin(0.5);
    this.input.once('pointerdown',()=>this.scene.start('StartScene'));
  }
}

const config={
  type:Phaser.AUTO,
  width:800,
  height:600,
  backgroundColor:'#000',
  physics:{default:'arcade',arcade:{debug:false}},
  scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},
  scene:[StartScene,GameScene]
};

new Phaser.Game(config);
</script>
</body>
</html>
